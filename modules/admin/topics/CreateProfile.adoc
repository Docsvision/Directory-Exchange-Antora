[[ariaid-title1]]
== Создание профиля подключения

Для подключения к БД и серверу Docsvision [.dfn .term]_Сервис репликации справочников_ использует настройки из [.dfn .term]_Профиля подключения_. В одном Профиле подключения указываются данные подключения только к одной БД сервера Docsvision: если используется несколько БД – нужно будет создать Профиль подключения для каждой из них.

Для создания Профиля подключения:

. Запустите программу «Консоль настроек репликации справочников Docsvision» из меню Пуск от имени локального администратора. При первом запуске будет предложено создать новый профиль подключения.
+
image::img/newProfile.png[[.fig--title-label]##Figure 1. ##Создание нового профиля подключения]
+
[NOTE]
====
[.note__title]#Note:# Общие настройки программы хранятся в реестре ОС.
====
. Введите название профиля, например, «Standard», и нажмите [.ph .uicontrol]*ОК*. Будет открыто окно настройки подключения.
+
image::img/editNewProfile.png[[.fig--title-label]##Figure 2. ##Редактирование профиля подключения]
. Заполните параметры в разделе «Параметры учетной записи сервиса»:
* Учётная запись – учётная запись, от имени которой будет запускаться Сервис репликации справочников. Может быть выбран один из предложенных вариантов:
** LocalSystem – использовать уч. запись LocalSystem;
** LocalService – использовать уч. запись LocalService;
** NetworkService – использовать уч. запись NetworkService;
** User – использовать указанную учётную запись.
* В полях «Имя пользователя» и «Пароль» введите данные учётной записи, если в настройке «Учётная запись» выбран вариант «User».
+
После xref:InstallReplicationService.adoc[установки «Сервиса репликации справочников»] с данным профилем подключения изменить учётную запись сервиса можно будет в настройках данной службы Windows. См. xref:InstallReplicationService.adoc[Установка Сервиса репликации справочников]
. Заполните параметры в разделе «Параметры подключения к Docsvision»:
* Строка подключения – адрес подключения к текущему серверу Docsvision в формате [.ph .filepath]`http://<Имя сервера Docsvision>/DocsVision/StorageServer/StorageServerService.asmx`.
* База – название БД текущего сервера Docsvision, если синхронизируется не БД по умолчанию.
* Имя пользователя / Пароль – данные учетной записи, от имени которой будет выполняться подключение к серверу Docsvision.
+
Учетная запись, от имени которой выполняется подключение, должна обладать правами администратора Docsvision.
+
Нажмите кнопку [.ph .uicontrol]*Проверить подключение* для проверки введённых данных.
. Заполните параметры в разделе «Параметры подключения к базе Docsvision»:
* Сервер – сетевое имя сервера с БД текущего сервера Docsvision (указанного в разделе «Параметры подключения к Docsvision»).
* Имя базы – название БД Docsvision. Должно соответствовать БД, указанной в разделе «Параметры подключения к Docsvision» – для БД по умолчанию нужно указать фактическое название БД.
* Использовать текущую учетную запись – установите флаг, если для подключения к БД должна использоваться аутентификация Windows (вместо SQL-аутентификации).
+
Обратите внимание: подключение к БД из программы «Консоль настроек репликации справочников Docsvision» будет выполнено от имени пользователя, запустившего программу, а при работе Сервиса репликации справочников будет использоваться учётная запись сервиса (указана в разделе «Параметры учетной записи сервиса»).
* Если флаг «Использовать текущую учетную запись» снят, в полях Имя пользователя / Пароль укажите данные учётной записи, от имени которой будет выполняться подключение к БД Docsvision.
+
Учетная запись, от имени которой выполняется подключение, должна обладать правами dbo на БД.
+
Нажмите кнопку [.ph .uicontrol]*Проверить подключение* для проверки введённых данных.
. Заполните параметры в разделе «Параметры подключения к базе журнала» (база с настройками и оперативными данными Модуля репликации справочников):
* Сервер – сетевое имя сервера с БД;
* Имя базы – название БД журнала синхронизации;
* Использовать текущую учетную запись – использовать аутентификация Windows для подключения к БД.
+
Особенности использования текущей учётной записи для подключения к БД см. выше.
* Если флаг «Использовать текущую учетную запись» снят, в полях Имя пользователя / Пароль укажите данные учётной записи, от имени которой будет выполняться подключение к БД.
* Установите флаг «Создать базу в случае ее отсутствия», чтобы БД журнала синхронизации была создана автоматически при первом подключении.
+
Учетная запись, от имени которой выполняется подключение, должна обладать правами dbo на БД. Для создания новой БД нужны права dbcreator.
+
Нажмите кнопку [.ph .uicontrol]*Проверить подключение* для проверки введённых данных. Если БД отсутствует и установлен флаг «Создать базу в случае ее отсутствия» – БД будет создана.
. Заполните параметры в разделе «Параметры переподключения к удалённому серверу».
+
Если в момент фоновой синхронизации производится обрыв соединения с удаленным сервером, то Сервис репликации пытается повторно подключиться к удаленному серверу через интервал, указанной в поле «Интервал между попытками (мс)». Количество попыток переподключения указывается в поле «Количество попыток переподключения».
+
Параметры в данном разделе следует устанавливать таким образом, чтобы общее время попыток переподключения не превышало интервал между синхронизациями, указанный в расписании обмена, а также время жизни сессии, указанное в Консоли настройки Docsvision для текущего сервера.

image::img/profile.png[[.fig--title-label]##Figure 3. ##Пример профиля подключения]

Если текущий сервер Docsvision работает с несколькими БД, для работы с каждой из них нужно создать отдельный профиль. См. пункт xref:CreateNewConnectionProfile.adoc[Создание нового профиля подключения].

*Parent topic:* xref:../topics/HowConfig.adoc[Подготовка к работе]
